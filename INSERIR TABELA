import psycopg2

# Conectar-se ao banco de dados PostgreSQL
conn = psycopg2.connect(
    dbname="nome_do_banco_de_dados",
    user="nome_de_usuario",
    password="senha",
    host="host",
    port="porta"
)

# Criar um cursor
cur = conn.cursor()

# Percorrer a lista de objetos criados anteriormente
for obj in lista_de_objetos:
    # Extrair os valores do objeto
    id_value = obj.id
    asin_value = obj.asin
    title_value = obj.title
    grupo_value = obj.grupo
    salesrank_value = obj.salesrank
    quant_categories_value = obj.quant_categories

    # Inserir os dados na tabela usando os nomes das colunas
    cur.execute("INSERT INTO MainTable (ID, ASIN, title, grupo, salesrank, quant_categories) "
                "VALUES (%s, %s, %s, %s, %s, %s)",
                (id_value, asin_value, title_value, grupo_value, salesrank_value, quant_categories_value))

# Confirmar a transação e fechar o cursor e a conexão
conn.commit()
cur.close()
conn.close()
